/*
 * @author electricessence / https://github.com/electricessence/
 * Based Upon: http://referencesource.microsoft.com/#System/CompMod/system/collections/generic/queue.cs
 * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md
 */
define(["require","exports","../Compare","./Array/Utility","../Types","../Integer","./Enumeration/EnumeratorBase","../Exceptions/NotImplementedException","../Exceptions/InvalidOperationException","../Exceptions/ArgumentOutOfRangeException","./CollectionBase","../../extends"],function(e,t,i,r,n,a,o,s,u,c,p,_){"use strict";function y(e,t){if(e<0)throw new c.ArgumentOutOfRangeException(t,e,"Must be greater than zero");return!0}function l(e,t){return a.Integer.assert(e,t),y(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var h=_["default"],f=void 0,d=4,v=32,m=100,E=d,g=Object.freeze([]),z=function(e){function t(t,a){void 0===a&&(a=i.areEqual);var o=e.call(this,f,a)||this;if(o._head=0,o._tail=0,o._size=0,t)if(n.Type.isNumber(t)){var s=t;l(s,"capacity"),o._array=s?r.initialize(s):g}else{var u=t;o._array=r.initialize(n.Type.isArrayLike(u)?u.length:E),o._importEntries(u)}else o._array=g;return o._capacity=o._array.length,o}return h(t,e),t.prototype.getCount=function(){return this._size},t.prototype._addInternal=function(e){var t=this,i=t._size,r=t._capacity;if(i==r){var n=r*m;n<r+d&&(n=r+d),t.setCapacity(n),r=t._capacity}var a=t._tail;return t._array[a]=e,t._tail=(a+1)%r,t._size=i+1,!0},t.prototype._removeInternal=function(e,t){throw new s.NotImplementedException("ICollection<T>.remove is not implemented in Queue<T> since it would require destroying the underlying array to remove the item.")},t.prototype._clearInternal=function(){var e=this,t=e._array,i=e._head,n=e._tail,a=e._size;return i<n?r.clear(t,i,n):(r.clear(t,i),r.clear(t,0,n)),e._head=0,e._tail=0,e._size=0,e.trimExcess(),a},t.prototype._onDispose=function(){e.prototype._onDispose.call(this),this._array!=g&&(this._array.length=this._capacity=0,this._array=g)},t.prototype.dump=function(e){void 0===e&&(e=1/0);var t=this,i=[];if(isFinite(e)){if(a.Integer.assertZeroOrGreater(e),0!==e)for(;e--&&t._tryDequeueInternal(function(e){i.push(e)}););}else for(;t._tryDequeueInternal(function(e){i.push(e)}););return t.trimExcess(),t._signalModification(),i},t.prototype.forEach=function(t){return e.prototype.forEach.call(this,t,!0)},t.prototype.setCapacity=function(e){var t=this;l(e,"capacity");var i=t._array,n=t._capacity;if(e>n&&t.throwIfDisposed(),e==n)return this;var a=t._head,o=t._tail,s=t._size;if(i!=g&&e>n&&a<o)return i.length=t._capacity=e,t._version++,this;var u=r.initialize(e);return s>0&&(a<o?r.copyTo(i,u,a,0,s):(r.copyTo(i,u,a,0,n-a),r.copyTo(i,u,0,n-a,o))),t._array=u,t._capacity=e,t._head=0,t._tail=s==e?0:s,t._signalModification(!0),this},t.prototype.enqueue=function(e){return this.add(e)},t.prototype._tryDequeueInternal=function(e){if(!this._size)return!1;var t=this._array,i=this._head,r=this._array[i];return t[i]=null,this._head=(i+1)%this._capacity,this._size--,this._incrementModified(),e(r),!0},t.prototype.dequeue=function(e){void 0===e&&(e=!1);var t=this;t.assertModifiable();var i=f;if(!this.tryDequeue(function(e){i=e})&&e)throw new u.InvalidOperationException("Cannot dequeue an empty queue.");return i},t.prototype.tryDequeue=function(e){var t=this;return!!t._size&&(t.assertModifiable(),!!this._tryDequeueInternal(e)&&(t._size<t._capacity/2&&t.trimExcess(v),t._signalModification(),!0))},t.prototype._getElement=function(e){l(e,"index");var t=this;return t._array[(t._head+e)%t._capacity]},t.prototype.peek=function(e){if(void 0===e&&(e=!1),0==this._size){if(e)throw new u.InvalidOperationException("Cannot call peek on an empty queue.");return f}return this._array[this._head]},t.prototype.trimExcess=function(e){var t=this,i=t._size;i<Math.floor(.9*t._capacity)&&(!e&&0!==e||isNaN(e)||e<i)&&t.setCapacity(i)},t.prototype.getEnumerator=function(){var e=this;e.throwIfDisposed();var t,i,r;return new o.EnumeratorBase(function(){i=e._version,r=e._size,t=0},function(n){return e.throwIfDisposed(),e.assertVersion(i),t==r?n.yieldBreak():n.yieldReturn(e._getElement(t++))})},t}(p.CollectionBase);t.Queue=z,t["default"]=z});
//# sourceMappingURL=Queue.js.map